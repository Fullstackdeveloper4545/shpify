{{ 'template-collection.css' | asset_url | stylesheet_tag }}
{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}

{%- assign chosen_collection = collections[section.settings.collection] -%}
{%- if chosen_collection == blank -%}
  {%- assign chosen_collection = collections['all'] -%}
{%- endif -%}

{%- assign products_to_show = section.settings.products_to_show | default: 12 -%}
{%- assign display_products = chosen_collection.products | slice: 0, products_to_show -%}

<div class="section-{{ section.id }}-padding page-width">
  {% if chosen_collection != blank %}
    <div class="title-wrapper center">
      <h2 class="title h2">{{ chosen_collection.title }}</h2>
    </div>

    {% if display_products.size > 0 %}
      <ul
        class="
          grid product-grid
          grid--{{ section.settings.columns_mobile }}-col-tablet-down
          grid--{{ section.settings.columns_desktop }}-col-desktop
        "
        role="list"
      >
        {%- for product in display_products -%}
          <li class="grid__item">
            {% render 'card-product',
              card_product: product,
              media_aspect_ratio: 'square',
              image_shape: 'default',
              show_secondary_image: true,
              show_vendor: false,
              show_rating: false,
              section_id: section.id
            %}
          </li>
        {%- endfor -%}
      </ul>
    {% else %}
      <p class="center">No products available in this collection.</p>
    {% endif %}
  {% else %}
    <p class="center">No products available in this collection.</p>
  {% endif %}
</div>

{% schema %}
{
  "name": "Produtos (coleção)",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "Coleção",
      "info": "Selecione a coleção para esta página. Se vazio, usa 'all'."
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Produtos para mostrar",
      "min": 4,
      "max": 50,
      "step": 2,
      "default": 12
    },
    {
      "type": "range",
      "id": "columns_desktop",
      "label": "Colunas no desktop",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 4
    },
    {
      "type": "select",
      "id": "columns_mobile",
      "label": "Colunas no mobile",
      "default": "2",
      "options": [
        { "value": "1", "label": "1" },
        { "value": "2", "label": "2" }
      ]
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 80,
      "step": 4,
      "default": 24,
      "label": "Padding superior"
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 80,
      "step": 4,
      "default": 24,
      "label": "Padding inferior"
    }
  ],
  "presets": [
    {
      "name": "Produtos (coleção)"
    }
  ]
}
{% endschema %}
